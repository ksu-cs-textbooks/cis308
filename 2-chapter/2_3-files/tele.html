<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.101.0">
    <meta name="generator" content="Relearn 5.0.3+tip">




	
	
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			

	
	
			
			
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			
			

	
	
			

	
	
			
			

	
	
			
			

	
	
			
			

    <meta name="description" content="CIS 308: C Language Lab">
    <meta name="author" content="Julie Thornton">
    <title>Files :: CIS 308 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis308/2-chapter/2_3-files/" rel="canonical" type="text/html" title="CIS 308 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis308/2-chapter/2_3-files/index.xml" rel="alternate" type="application/rss+xml" title="CIS 308 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis308/_print/2-chapter/2_3-files/" rel="alternate" type="text/html" title="CIS 308 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis308/2-chapter/2_3-files/embed.html" rel="alternate" type="text/html" title="CIS 308 Textbook">
    
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/fontawesome-all.min.css?1659549501" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/featherlight.min.css?1659549501" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/auto-complete.css?1659549501" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;">
    <noscript>
      <link href="https://ksu-cs-textbooks.github.io/cis308/css/fontawesome-all.min.css?1659549501" rel="stylesheet">
      <link href="https://ksu-cs-textbooks.github.io/cis308/css/featherlight.min.css?1659549501" rel="stylesheet">
      <link href="https://ksu-cs-textbooks.github.io/cis308/css/auto-complete.css?1659549501" rel="stylesheet">
    </noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/perfect-scrollbar.min.css?1659549501" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/nucleus.css?1659549501" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/fonts.css?1659549501" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/theme.css?1659549501" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/theme-light-theme.css?1659549501" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/ie.css?1659549501" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/variant.css?1659549501" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/print.css?1659549501" rel="stylesheet" media="print">
    <script src="https://ksu-cs-textbooks.github.io/cis308/js/variant.js?1659549501"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      var index_url="https://ksu-cs-textbooks.github.io/cis308/index.json";
      var root_url="https://ksu-cs-textbooks.github.io/cis308/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis308/';
      variants.init( [ 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis308/css/custom.css?1659549501" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis308/js/jquery.min.js?1659549501" defer></script>

  </head>
  <body class="mobile-support disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis308/2-chapter/2_3-files/">
    
    <div id="tele" class="tele mirror">
    
    <div id="body" class="default-animation">
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="default">
    
    
<h1>Files</h1>
    
    
<p>This section contains information on opening a file, reading from a file, and writing to a file. I only cover how to interact with text files – it is also possible to read from and write to binary files.</p>
<p>Whenever you are doing file I/O, you need to add:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span></code></pre></div><h2 id="opening-a-file">Opening a File</h2>
<p>Before we can interact with a file, we need to open it. The <code>fopen</code> function lets us open files for different kinds of input and output. Here&rsquo;s the prototype:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>FILE<span style="color:#f92672">*</span> fopen(<span style="color:#66d9ef">char</span>[] filename, <span style="color:#66d9ef">char</span>[] mode)
</span></span></code></pre></div><p>The <code>FILE*</code> return type means that the function is returning the address of a <code>FILE</code> object. We&rsquo;ll learn more about pointers in the next section. If the file could not be opened, fopen returns <code>NULL</code>.</p>
<p>Here, <code>filename</code> is a string representation of the filename, such as &ldquo;data.txt&rdquo;. <code>fopen</code> searches the current directory for the file if no absolute path is given. The string <code>mode</code> specifies what type of operations you want to do on the file.</p>
<p>Here are the different options for the mode:</p>
<table>
<thead>
<tr>
<th>Mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>&ldquo;r&rdquo;</td>
<td>Open for reading (file must exist)</td>
</tr>
<tr>
<td>&ldquo;w&rdquo;</td>
<td>Open for writing (overwrites old data)</td>
</tr>
<tr>
<td>&ldquo;a&rdquo;</td>
<td>Open for appending (creates file if necessary)</td>
</tr>
<tr>
<td>&ldquo;r+&rdquo;</td>
<td>Open for reading and writing (file must exist)</td>
</tr>
<tr>
<td>&ldquo;w+&rdquo;</td>
<td>Open for reading and writing (overwrites old data)</td>
</tr>
<tr>
<td>&ldquo;a+&rdquo;</td>
<td>Open for reading and appending (opens at end of file)</td>
</tr>
</tbody>
</table>
<p>For example, we can open the file &ldquo;data.txt&rdquo; for reading, and print an error if we were unsuccessful:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>FILE <span style="color:#f92672">*</span>fp <span style="color:#f92672">=</span> fopen(<span style="color:#e6db74">&#34;data.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (fp <span style="color:#f92672">==</span> NULL) {
</span></span><span style="display:flex;"><span>  printf(<span style="color:#e6db74">&#34;Error opening file</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>After we are done reading from a file or writing to a file, we must close the file with the <code>fclose</code> function. Here&rsquo;s the prototype:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> fclose(FILE<span style="color:#f92672">*</span> fp)
</span></span></code></pre></div><p>To close data.txt, we&rsquo;d do:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>fclose(fp);
</span></span></code></pre></div><h2 id="reading-from-a-file">Reading from a File</h2>
<p>There are two major functions for reading from a file – <code>fscanf</code> and <code>fgets</code>. <code>fgets</code> works exactly like we&rsquo;ve seen before, except now we specify a <code>FILE*</code> instead of <code>stdin</code>. <code>fscanf</code> works exactly like <code>scanf</code>, except we first specify the <code>FILE*</code>. We&rsquo;ll start with <code>fscanf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> fscanf(FILE <span style="color:#f92672">*</span>stream, <span style="color:#66d9ef">char</span> str[], variable addresses...)
</span></span></code></pre></div><p><code>fscanf</code>, like <code>scanf</code>, returns the number of variables that were correctly read in. If it was unable to read any more input, the <code>EOF</code> constant is returned. Thus we can compare the return value of <code>fscanf</code> to <code>EOF</code> to see if we&rsquo;ve reached the end of the file.</p>
<p>Suppose the file data.txt looks like this (a bunch of names and ages, each on separate lines):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Bob 20
</span></span><span style="display:flex;"><span>Jill 15
</span></span><span style="display:flex;"><span>Tony 17
</span></span><span style="display:flex;"><span>Lisa 22
</span></span></code></pre></div><p>We want to read this file, and print something like &ldquo;Bob is 20 years old&rdquo; to the console for each person in the file. Here&rsquo;s how:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>FILE <span style="color:#f92672">*</span>fp <span style="color:#f92672">=</span> fopen(<span style="color:#e6db74">&#34;data.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> name[<span style="color:#ae81ff">20</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> age;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (fp <span style="color:#f92672">!=</span> NULL) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (fscanf(fp, <span style="color:#e6db74">&#34;%s %d&#34;</span>, name, <span style="color:#f92672">&amp;</span>age) <span style="color:#f92672">!=</span> EOF) {
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;%s is %d years old</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, name, age);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  fclose(fp);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, lets try to do the same thing with the <code>fgets</code> function. Here&rsquo;s the prototype:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">char</span>[] fgets(<span style="color:#66d9ef">char</span> s[], <span style="color:#66d9ef">int</span> size, FILE <span style="color:#f92672">*</span>stream)
</span></span></code></pre></div><p><code>fgets</code> reads a string from a specified file into the <code>s</code> array. The <code>size</code> parameter specifies the size of the string – it will not write past the end of the array. It returns a reference to the string that was read. If no string was read (specifying an error or the end of file), <code>NULL</code> is returned.
<code>fgets</code> will attempt to read <code>size-1</code> characters <em>unless it reaches a newline or the end of the file</em>.</p>
<p>Here&rsquo;s the same example repeated with <code>fgets</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>FILE <span style="color:#f92672">*</span>fp <span style="color:#f92672">=</span> fopen(<span style="color:#e6db74">&#34;data.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> name[<span style="color:#ae81ff">20</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> buf[<span style="color:#ae81ff">30</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> age;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (fp <span style="color:#f92672">!=</span> NULL) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> (fgets(buf, <span style="color:#ae81ff">30</span>, fp) <span style="color:#f92672">!=</span> NULL) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//parse the current line
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>token <span style="color:#f92672">=</span> strtok(buf, <span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>    strcpy(name, token);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//get the age
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    token <span style="color:#f92672">=</span> strtok(buf, <span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>    age <span style="color:#f92672">=</span> atoi(token);
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;%s is %d years old</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, name, age);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  fclose(fp);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Reading files with <code>fscanf</code> is usually simpler (since it doesn&rsquo;t involve parsing lines), but it is more error-prone than <code>fgets</code>.</p>
<h2 id="writing-to-a-file">Writing to a File</h2>
<p>The primary function for writing to a file is <code>fprintf</code>. This function works exactly like <code>printf</code>, but the first argument is now a <code>FILE*</code>. Here&rsquo;s the prototype:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> fprintf(FILE<span style="color:#f92672">*</span> fp, <span style="color:#66d9ef">char</span> str[], variables to print...)
</span></span></code></pre></div><p>Here is an example that will ask the user to input 10 numbers. Each number will be written on a separate line to the file out.txt:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>FILE <span style="color:#f92672">*</span>fp <span style="color:#f92672">=</span> fopen(<span style="color:#e6db74">&#34;out.txt&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (fp <span style="color:#f92672">!=</span> NULL) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> num, i;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Type a number: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;%d&#34;</span>, num);
</span></span><span style="display:flex;"><span>    fprintf(fp, <span style="color:#e6db74">&#34;%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, num);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  fclose(fp);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
            <footer class="footline">
            </footer>
          </article>

        </div>
      </main>
    
    
    </div>
    
  </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis308/js/clipboard.min.js?1659549501" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis308/js/perfect-scrollbar.min.js?1659549501" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis308/js/featherlight.min.js?1659549501" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis308/js/theme.js?1659549501" defer></script>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis308/js/tele-scroll.js?1659549501 defer"></script>
    
  </body>
</html>
